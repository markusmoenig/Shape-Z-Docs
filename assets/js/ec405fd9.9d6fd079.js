(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[5523],{419:()=>{},3434:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(6540),s=r(961),i=r(8553),o=r(4779),a=r(8918),c=r(8215);var l=r(4848);function d({src:e=null,code:t="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:r=400,initialSplit:d=80,autoCompile:h=!1,caption:u="",renderWidth:p=300,renderHeight:f=300,samplesPerFrame:m=1,totalSamples:x=10}){const[g,y]=(0,n.useState)(t),[j,w]=(0,n.useState)("Ready"),[v,b]=(0,n.useState)(!1),[k,R]=(0,n.useState)("Ready"),[C,S]=(0,n.useState)(""),M=(0,n.useRef)(null),z=(0,n.useRef)(null),_=(0,n.useRef)(null),E=(0,n.useRef)(null),D=(0,n.useRef)(0),B=(0,n.useRef)(!1),P=(0,n.useRef)(null),L="undefined"!=typeof window,A=async()=>{await new Promise(e=>requestAnimationFrame(()=>e())),await new Promise(e=>setTimeout(e,0))},W=(0,n.useCallback)(e=>{if(!z.current||!_.current)return;const t=Math.min(90,Math.max(10,e));z.current.style.width=`${t}%`,_.current.style.width=100-t+"%"},[]),I=()=>{D.current&&cancelAnimationFrame(D.current),D.current=0};(0,n.useEffect)(()=>{if(!L)return;if(!e)return;if(I(),E.current){const e=E.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let t=!1;return w("Loading source\u2026"),fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to load ${e} (${t.status})`);return t.text()}).then(e=>{t||(y(e),w("Source loaded"))}).catch(e=>{t||(console.error(e),w("Load failed: "+(e.message||e)))}),()=>{t=!0}},[e,L]);const F=(0,n.useCallback)((e,t,r)=>{const n=E.current;if(!n)return;n.width!==t&&(n.width=t),n.height!==r&&(n.height=r);const s=n.getContext("2d");if(e&&e.length){const n=new ImageData(new Uint8ClampedArray(e),t,r);s.putImageData(n,0,0)}else s.clearRect(0,0,n.width,n.height)},[]),T=(0,n.useCallback)(async e=>{if(e.Renderer&&"function"==typeof e.Renderer){const n=new e.Renderer(g,p,f);if("function"==typeof n.set_target_samples)try{n.set_target_samples(x>>>0)}catch(t){}let s=x>>>0;if("function"==typeof n.target_samples)try{s=n.target_samples()}catch(t){}try{if("function"==typeof n.prepare&&n.prepare(),"function"==typeof n.exec_summary){const e=n.exec_summary();e&&R(e)}}catch(r){return console.error("Renderer prepare failed:",r),void S("ERR")}await A(),S(`0/${s}`);const i=()=>{try{let e=!1;const r=m>>>0||1;if("function"==typeof n.step_samples)e=n.step_samples(r);else{if("function"!=typeof n.step)throw new Error("Renderer has no step/step_samples");e=n.step(r)}const o=n.frame_rgba();F(o,n.width,n.height);let a=0,c=null;if("function"==typeof n.progress)try{a=Math.max(0,Math.min(1,n.progress()))}catch(t){}if("function"==typeof n.current_samples)try{c=n.current_samples()}catch(t){}null!=c&&s&&(a=Math.max(a,Math.min(1,c/s)));Math.round(100*a);const l=null!=c?c:Math.round(a*s);S(`${l}/${s}`),e?(S(""),D.current=0):D.current=requestAnimationFrame(i)}catch(r){console.error("Progressive render failed:",r),S("ERR"),D.current=0}};return void i()}if("function"==typeof e.compile){w("Compiling\u2026");const t=e.compile(g);if(!t||0===t.length)throw new Error("Empty byte buffer");const r=new Blob([t],{type:"image/png"}),n=URL.createObjectURL(r),s=new Image;return s.onload=()=>{const e=E.current;if(!e)return;e.width=s.width,e.height=s.height;e.getContext("2d").drawImage(s,0,0),URL.revokeObjectURL(n),S("")},s.onerror=()=>w("Render failed"),void(s.src=n)}throw new Error("No rendering function found in WASM module")},[g,p,f,m,x,F]),$=(0,n.useCallback)(async()=>{I(),(0,s.flushSync)(()=>{b(!0),S("Compiling Voxels\u2026")}),await A();try{if(!L||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){w("Checking\u2026");const t=e.compile_check(g,p,f),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;if(R(n||(r?"OK":"Error")),!r)return S(""),void b(!1)}await T(e)}catch(e){console.error(e),w(String(e.message||e)),S("")}finally{b(!1)}},[L,g,p,f,T]),N=(0,n.useCallback)(async()=>{I(),S("");try{if(!L||!window.shapezWasmModule)return;const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){w("Checking\u2026");const t=e.compile_check(g,p,f),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;R(n||(r?"OK":"Error"))}}catch(e){console.error(e),w(String(e.message||e))}},[L,g,p,f]);(0,n.useEffect)(()=>{if(!L)return;const e=`shpz-split:${location.pathname}:${u||"default"}`;P.current=e;const t=Number(sessionStorage.getItem(e));W(!Number.isNaN(t)&&t>0?t:d)},[W,u,d,L]),(0,n.useEffect)(()=>{if(!h)return;const e=setTimeout(()=>N(),350);return()=>clearTimeout(e)},[g,h,N]);const O=e=>{if(!B.current||!M.current)return;const t=M.current.getBoundingClientRect(),r=(e.clientX-t.left)/t.width*100;W(r)},U=()=>{if(B.current&&(B.current=!1,L&&P.current&&z.current&&M.current)){const e=M.current.getBoundingClientRect(),t=z.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(P.current,String(Math.round(t)))}};return(0,n.useEffect)(()=>{if(L)return window.addEventListener("mousemove",O),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",U),I()}},[L]),(0,l.jsxs)("div",{ref:M,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${r}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)",marginBottom:"1.5rem"},children:[u?(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:[(0,l.jsx)("span",{children:u}),(0,l.jsx)("span",{style:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontVariantNumeric:"tabular-nums",opacity:.75},children:C})]}):null,(0,l.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,l.jsx)("div",{ref:z,style:{width:"50%",minWidth:"20%"},children:(0,l.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:g,onChange:e=>{I(),S(""),y(e??"")},theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1},onMount:async(e,t)=>{try{await async function(e,t){const r=await fetch("/onigasm.wasm");await(0,c.loadWASM)(await r.arrayBuffer()),e.languages.register({id:"shpz"});const n=new o.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),s=new Map([["shpz","source.shpz"]]);await(0,a.J)(e,n,s,t)}(t,e)}catch(r){console.error("Grammar setup failed:",r)}}})}),(0,l.jsx)("div",{onMouseDown:()=>{B.current=!0},onDoubleClick:()=>W(d),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,l.jsx)("div",{ref:_,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,l.jsx)("canvas",{ref:E,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,l.jsx)("button",{onClick:$,disabled:v,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:v?"default":"pointer",opacity:v?.85:1,transition:"opacity 120ms ease"},children:v?"Working\u2026":"Compile & Render"})}),(0,l.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:k})]})]})}},9675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"patters","title":"Patterns","description":"Patterns in Shape-Z use the u, v, d coordinates provided by shapes and their segments. This makes them reusable across different shapes like Rect or Disc, and ensures they adapt cleanly to varying scale and orientation.","source":"@site/docs/patters.mdx","sourceDirName":".","slug":"/patters","permalink":"/docs/patters","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Patterns"},"sidebar":"tutorialSidebar","previous":{"title":"Distance Volumes","permalink":"/docs/distance"},"next":{"title":"Internals & Todo","permalink":"/docs/internals"}}');var s=r(4848),i=r(8453),o=r(3434);const a={sidebar_position:5,title:"Patterns"},c=void 0,l={},d=[{value:"Bricks",id:"bricks",level:2},{value:"Example",id:"example",level:4},{value:"Modulo",id:"modulo",level:2},{value:"Example",id:"example-1",level:4}];function h(e){const t={code:"code",h2:"h2",h4:"h4",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Patterns"})," in Shape-Z use the ",(0,s.jsx)(t.code,{children:"u"}),", ",(0,s.jsx)(t.code,{children:"v"}),", ",(0,s.jsx)(t.code,{children:"d"})," coordinates provided by ",(0,s.jsx)(t.code,{children:"shapes"})," and their ",(0,s.jsx)(t.code,{children:"segments"}),". This makes them reusable across different shapes like ",(0,s.jsx)(t.code,{children:"Rect"})," or ",(0,s.jsx)(t.code,{children:"Disc"}),", and ensures they adapt cleanly to varying scale and orientation."]}),"\n",(0,s.jsxs)(t.p,{children:["Patterns define repeating structures or logic within a shape\u2019s ",(0,s.jsx)(t.code,{children:"volume"})," block. Each pattern may expose special variables like ",(0,s.jsx)(t.code,{children:"hash"})," for variation between cells."]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"bricks",children:"Bricks"}),"\n",(0,s.jsx)(t.p,{children:"Creates a staggered brick wall pattern, with support for mortar gaps and rounded corners."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"size: vec2"})," \u2014 Size of one brick in ",(0,s.jsx)(t.code,{children:"u"}),", ",(0,s.jsx)(t.code,{children:"v"})," space. Default: ",(0,s.jsx)(t.code,{children:"vec2(1.2, 0.15)"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"gap: float"})," \u2014 Width of the space between bricks. Default: ",(0,s.jsx)(t.code,{children:"0.01"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"rounding: float"})," \u2014 Rounds the corners of each brick. Default: ",(0,s.jsx)(t.code,{children:"0.0"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"brick {}"})," \u2014 Block executed for each brick"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"cement {}"})," \u2014 Block executed for each mortar (non-brick space)"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Material integration:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hash"})," \u2014 A float between 0.0 and 1.0 unique to each brick, passed to the material system for per-brick color variation."]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"example",children:"Example"}),"\n",(0,s.jsx)(o.A,{src:"/examples/pattern_bricks.shpz",height:500,caption:"Bricks Pattern"}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"modulo",children:"Modulo"}),"\n",(0,s.jsxs)(t.p,{children:["Splits space into a regular grid of ",(0,s.jsx)(t.code,{children:"u"}),"/",(0,s.jsx)(t.code,{children:"v"})," cells and alternates between two outputs."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Parameters:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"size: float"})," \u2014 Size of each repeating cell in ",(0,s.jsx)(t.code,{children:"u"}),", ",(0,s.jsx)(t.code,{children:"v"}),". Default: ",(0,s.jsx)(t.code,{children:"0.02"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"even {}"})," \u2014 Block executed for even tiles"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"odd {}"})," \u2014 Block executed for odd tiles"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This is useful for checkerboards, alternating patterns, or dithering effects."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Material integration:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hash"})," \u2014 A float between 0.0 and 1.0 unique to each cell, passed to the material system for per-cell color variation."]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(o.A,{src:"/examples/pattern_modulo.shpz",height:500,caption:"Modulo Pattern"})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);