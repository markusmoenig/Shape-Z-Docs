(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[7668],{419:()=>{},3434:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(6540),o=r(961),i=r(8553),s=r(4779),a=r(8918),c=r(8215);var l=r(4848);function d({src:e=null,code:t="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:r=400,initialSplit:d=80,autoCompile:u=!1,caption:m="",renderWidth:h=300,renderHeight:f=300,samplesPerFrame:p=1,totalSamples:g=10}){const[y,w]=(0,n.useState)(t),[x,b]=(0,n.useState)("Ready"),[v,k]=(0,n.useState)(!1),[j,R]=(0,n.useState)("Ready"),[C,S]=(0,n.useState)(""),z=(0,n.useRef)(null),M=(0,n.useRef)(null),_=(0,n.useRef)(null),E=(0,n.useRef)(null),L=(0,n.useRef)(0),W=(0,n.useRef)(!1),B=(0,n.useRef)(null),I="undefined"!=typeof window,A=async()=>{await new Promise(e=>requestAnimationFrame(()=>e())),await new Promise(e=>setTimeout(e,0))},F=(0,n.useCallback)(e=>{if(!M.current||!_.current)return;const t=Math.min(90,Math.max(10,e));M.current.style.width=`${t}%`,_.current.style.width=100-t+"%"},[]),D=()=>{L.current&&cancelAnimationFrame(L.current),L.current=0};(0,n.useEffect)(()=>{if(!I)return;if(!e)return;if(D(),E.current){const e=E.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let t=!1;return b("Loading source\u2026"),fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to load ${e} (${t.status})`);return t.text()}).then(e=>{t||(w(e),b("Source loaded"))}).catch(e=>{t||(console.error(e),b("Load failed: "+(e.message||e)))}),()=>{t=!0}},[e,I]);const $=(0,n.useCallback)((e,t,r)=>{const n=E.current;if(!n)return;n.width!==t&&(n.width=t),n.height!==r&&(n.height=r);const o=n.getContext("2d");if(e&&e.length){const n=new ImageData(new Uint8ClampedArray(e),t,r);o.putImageData(n,0,0)}else o.clearRect(0,0,n.width,n.height)},[]),N=(0,n.useCallback)(async e=>{if(e.Renderer&&"function"==typeof e.Renderer){const n=new e.Renderer(y,h,f);if("function"==typeof n.set_target_samples)try{n.set_target_samples(g>>>0)}catch(t){}let o=g>>>0;if("function"==typeof n.target_samples)try{o=n.target_samples()}catch(t){}try{if("function"==typeof n.prepare&&n.prepare(),"function"==typeof n.exec_summary){const e=n.exec_summary();e&&R(e)}}catch(r){return console.error("Renderer prepare failed:",r),void S("ERR")}await A(),S(`0/${o}`);const i=()=>{try{let e=!1;const r=p>>>0||1;if("function"==typeof n.step_samples)e=n.step_samples(r);else{if("function"!=typeof n.step)throw new Error("Renderer has no step/step_samples");e=n.step(r)}const s=n.frame_rgba();$(s,n.width,n.height);let a=0,c=null;if("function"==typeof n.progress)try{a=Math.max(0,Math.min(1,n.progress()))}catch(t){}if("function"==typeof n.current_samples)try{c=n.current_samples()}catch(t){}null!=c&&o&&(a=Math.max(a,Math.min(1,c/o)));Math.round(100*a);const l=null!=c?c:Math.round(a*o);S(`${l}/${o}`),e?(S(""),L.current=0):L.current=requestAnimationFrame(i)}catch(r){console.error("Progressive render failed:",r),S("ERR"),L.current=0}};return void i()}if("function"==typeof e.compile){b("Compiling\u2026");const t=e.compile(y);if(!t||0===t.length)throw new Error("Empty byte buffer");const r=new Blob([t],{type:"image/png"}),n=URL.createObjectURL(r),o=new Image;return o.onload=()=>{const e=E.current;if(!e)return;e.width=o.width,e.height=o.height;e.getContext("2d").drawImage(o,0,0),URL.revokeObjectURL(n),S("")},o.onerror=()=>b("Render failed"),void(o.src=n)}throw new Error("No rendering function found in WASM module")},[y,h,f,p,g,$]),Z=(0,n.useCallback)(async()=>{D(),(0,o.flushSync)(()=>{k(!0),S("Compiling Voxels\u2026")}),await A();try{if(!I||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){b("Checking\u2026");const t=e.compile_check(y,h,f),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;if(R(n||(r?"OK":"Error")),!r)return S(""),void k(!1)}await N(e)}catch(e){console.error(e),b(String(e.message||e)),S("")}finally{k(!1)}},[I,y,h,f,N]),G=(0,n.useCallback)(async()=>{D(),S("");try{if(!I||!window.shapezWasmModule)return;const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){b("Checking\u2026");const t=e.compile_check(y,h,f),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;R(n||(r?"OK":"Error"))}}catch(e){console.error(e),b(String(e.message||e))}},[I,y,h,f]);(0,n.useEffect)(()=>{if(!I)return;const e=`shpz-split:${location.pathname}:${m||"default"}`;B.current=e;const t=Number(sessionStorage.getItem(e));F(!Number.isNaN(t)&&t>0?t:d)},[F,m,d,I]),(0,n.useEffect)(()=>{if(!u)return;const e=setTimeout(()=>G(),350);return()=>clearTimeout(e)},[y,u,G]);const O=e=>{if(!W.current||!z.current)return;const t=z.current.getBoundingClientRect(),r=(e.clientX-t.left)/t.width*100;F(r)},T=()=>{if(W.current&&(W.current=!1,I&&B.current&&M.current&&z.current)){const e=z.current.getBoundingClientRect(),t=M.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(B.current,String(Math.round(t)))}};return(0,n.useEffect)(()=>{if(I)return window.addEventListener("mousemove",O),window.addEventListener("mouseup",T),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",T),D()}},[I]),(0,l.jsxs)("div",{ref:z,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${r}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)",marginBottom:"1.5rem"},children:[m?(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:[(0,l.jsx)("span",{children:m}),(0,l.jsx)("span",{style:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontVariantNumeric:"tabular-nums",opacity:.75},children:C})]}):null,(0,l.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,l.jsx)("div",{ref:M,style:{width:"50%",minWidth:"20%"},children:(0,l.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:y,onChange:e=>{D(),S(""),w(e??"")},theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1},onMount:async(e,t)=>{try{await async function(e,t){const r=await fetch("/onigasm.wasm");await(0,c.loadWASM)(await r.arrayBuffer()),e.languages.register({id:"shpz"});const n=new s.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),o=new Map([["shpz","source.shpz"]]);await(0,a.J)(e,n,o,t)}(t,e)}catch(r){console.error("Grammar setup failed:",r)}}})}),(0,l.jsx)("div",{onMouseDown:()=>{W.current=!0},onDoubleClick:()=>F(d),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,l.jsx)("div",{ref:_,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,l.jsx)("canvas",{ref:E,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,l.jsx)("button",{onClick:Z,disabled:v,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:v?"default":"pointer",opacity:v?.85:1,transition:"opacity 120ms ease"},children:v?"Working\u2026":"Compile & Render"})}),(0,l.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:j})]})]})}},3567:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>u,contentTitle:()=>d,default:()=>f,frontMatter:()=>l,metadata:()=>n,toc:()=>m});const n=JSON.parse('{"type":"mdx","permalink":"/gallery","source":"@site/src/pages/gallery.mdx","title":"Shape-Z Gallery","description":"Click an image to view, edit and render the Shape-Z code below.","frontMatter":{},"unlisted":false}');var o=r(4848),i=r(8453),s=r(6540),a=r(3434);function c({image:e,src:t,caption:r}){const[n,i]=(0,s.useState)(!1);return(0,o.jsxs)("div",{style:{marginBottom:48},children:[(0,o.jsx)("img",{src:e,onClick:()=>i(!n),alt:r,style:{width:"100%",maxWidth:800,cursor:"pointer",borderRadius:6,border:"1px solid #ccc",display:"block",marginBottom:8}}),r&&(0,o.jsx)("div",{style:{fontSize:14,marginBottom:12},children:r}),n&&(0,o.jsx)(a.A,{src:t,height:500,caption:r})]})}const l={},d="Shape-Z Gallery",u={},m=[];function h(e){const t={a:"a",admonition:"admonition",h1:"h1",header:"header",p:"p",strong:"strong",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"shape-z-gallery",children:"Shape-Z Gallery"})}),"\n",(0,o.jsx)(t.p,{children:"Click an image to view, edit and render the Shape-Z code below."}),"\n",(0,o.jsx)(t.admonition,{type:"info",children:(0,o.jsxs)(t.p,{children:["For best performance, ",(0,o.jsx)(t.a,{href:"/docs/installation",children:"install the native version"})," of ",(0,o.jsx)(t.strong,{children:"Shape-Z"}),". While the web version supports multi-threading, it is still significantly slower due to current WebAssembly limitations\u2014such as the lack of SIMD and less efficient threading. For example, the Lighthouse demo may fail to compile in the browser but compiles in under a second natively on my machine."]})}),"\n",(0,o.jsx)(c,{image:"/img/examples/bathroom.png",src:"/img/examples/bathroom.shpz",caption:"Bathroom"}),"\n",(0,o.jsx)(c,{image:"/img/examples/bottle.png",src:"/img/examples/bottle.shpz",caption:"Whiskey Bottle"}),"\n",(0,o.jsx)(c,{image:"/img/examples/lighthouse.png",src:"/img/examples/lighthouse.shpz",caption:"Lighthouse"})]})}function f(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);