(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[802],{419:()=>{},3434:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(6540),o=n(961),i=n(8553),s=n(4779),a=n(8918),c=n(8215);var l=n(4848);function u({src:e=null,code:t="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:n=400,initialSplit:u=80,autoCompile:d=!1,caption:f="",renderWidth:m=400,renderHeight:h=400,samplesPerFrame:p=1,totalSamples:g=10}){const[w,y]=(0,r.useState)(t),[x,b]=(0,r.useState)("Ready"),[v,k]=(0,r.useState)(!1),[R,C]=(0,r.useState)("Ready"),[j,S]=(0,r.useState)(""),M=(0,r.useRef)(null),z=(0,r.useRef)(null),_=(0,r.useRef)(null),E=(0,r.useRef)(null),I=(0,r.useRef)(0),L=(0,r.useRef)(!1),W=(0,r.useRef)(null),A="undefined"!=typeof window,D=async()=>{await new Promise(e=>requestAnimationFrame(()=>e())),await new Promise(e=>setTimeout(e,0))},F=(0,r.useCallback)(e=>{if(!z.current||!_.current)return;const t=Math.min(90,Math.max(10,e));z.current.style.width=`${t}%`,_.current.style.width=100-t+"%"},[]),$=()=>{I.current&&cancelAnimationFrame(I.current),I.current=0};(0,r.useEffect)(()=>{if(!A)return;if(!e)return;if($(),E.current){const e=E.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let t=!1;return b("Loading source\u2026"),fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to load ${e} (${t.status})`);return t.text()}).then(e=>{t||(y(e),b("Source loaded"))}).catch(e=>{t||(console.error(e),b("Load failed: "+(e.message||e)))}),()=>{t=!0}},[e,A]);const N=(0,r.useCallback)((e,t,n)=>{const r=E.current;if(!r)return;r.width!==t&&(r.width=t),r.height!==n&&(r.height=n);const o=r.getContext("2d");if(e&&e.length){const r=new ImageData(new Uint8ClampedArray(e),t,n);o.putImageData(r,0,0)}else o.clearRect(0,0,r.width,r.height)},[]),B=(0,r.useCallback)(async e=>{if(await D(),e.Renderer&&"function"==typeof e.Renderer){const n=new e.Renderer(w,m,h);if("function"==typeof n.set_target_samples)try{n.set_target_samples(g>>>0)}catch(t){}S(`0/${g}`);const r=()=>{try{let e=!1;const o=p>>>0||1;if("function"==typeof n.step_samples)e=n.step_samples(o);else{if("function"!=typeof n.step)throw new Error("Renderer has no step/step_samples");e=n.step(o)}const i=n.frame_rgba();N(i,n.width,n.height);let s=0,a=null,c=g;if("function"==typeof n.progress)try{s=Math.max(0,Math.min(1,n.progress()))}catch(t){}if("function"==typeof n.current_samples)try{a=n.current_samples()}catch(t){}if("function"==typeof n.target_samples)try{c=n.target_samples()}catch(t){}null!=a&&c&&(s=Math.max(s,Math.min(1,a/c)));Math.round(100*s);const l=null!=a?a:Math.round(s*c);S(`${l}/${c}`),e?(S(""),I.current=0):I.current=requestAnimationFrame(r)}catch(e){console.error("Progressive render failed:",e),S("ERR"),I.current=0}};return void r()}if("function"==typeof e.compile){b("Compiling\u2026");const t=e.compile(w);if(!t||0===t.length)throw new Error("Empty byte buffer");const n=new Blob([t],{type:"image/png"}),r=URL.createObjectURL(n),o=new Image;return o.onload=()=>{const e=E.current;if(!e)return;e.width=o.width,e.height=o.height;e.getContext("2d").drawImage(o,0,0),URL.revokeObjectURL(r),S("")},o.onerror=()=>b("Render failed"),void(o.src=r)}throw new Error("No rendering function found in WASM module")},[w,m,h,p,g,N]),P=(0,r.useCallback)(async()=>{$(),(0,o.flushSync)(()=>{k(!0),S("Compiling Voxels\u2026")}),await D();try{if(!A||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){b("Checking\u2026");const t=e.compile_check(w,m,h),n="function"==typeof t.ok?t.ok():t.ok,r="function"==typeof t.message?t.message():t.message;if(C(r||(n?"OK":"Error")),!n)return S(""),void k(!1)}await B(e)}catch(e){console.error(e),b(String(e.message||e)),S("")}finally{k(!1)}},[A,w,m,h,B]),O=(0,r.useCallback)(async()=>{$(),S("");try{if(!A||!window.shapezWasmModule)return;const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){b("Checking\u2026");const t=e.compile_check(w,m,h),n="function"==typeof t.ok?t.ok():t.ok,r="function"==typeof t.message?t.message():t.message;C(r||(n?"OK":"Error"))}}catch(e){console.error(e),b(String(e.message||e))}},[A,w,m,h]);(0,r.useEffect)(()=>{if(!A)return;const e=`shpz-split:${location.pathname}:${f||"default"}`;W.current=e;const t=Number(sessionStorage.getItem(e));F(!Number.isNaN(t)&&t>0?t:u)},[F,f,u,A]),(0,r.useEffect)(()=>{if(!d)return;const e=setTimeout(()=>O(),350);return()=>clearTimeout(e)},[w,d,O]);const T=e=>{if(!L.current||!M.current)return;const t=M.current.getBoundingClientRect(),n=(e.clientX-t.left)/t.width*100;F(n)},U=()=>{if(L.current&&(L.current=!1,A&&W.current&&z.current&&M.current)){const e=M.current.getBoundingClientRect(),t=z.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(W.current,String(Math.round(t)))}};return(0,r.useEffect)(()=>{if(A)return window.addEventListener("mousemove",T),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",U),$()}},[A]),(0,l.jsxs)("div",{ref:M,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${n}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)"},children:[f?(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:[(0,l.jsx)("span",{children:f}),(0,l.jsx)("span",{style:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontVariantNumeric:"tabular-nums",opacity:.75},children:j})]}):null,(0,l.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,l.jsx)("div",{ref:z,style:{width:"50%",minWidth:"20%"},children:(0,l.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:w,onChange:e=>{$(),S(""),y(e??"")},theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1}},onMount:async(e,t)=>{try{await async function(e,t){const n=await fetch("/onigasm.wasm");await(0,c.loadWASM)(await n.arrayBuffer()),e.languages.register({id:"shpz"});const r=new s.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),o=new Map([["shpz","source.shpz"]]);await(0,a.J)(e,r,o,t)}(t,e)}catch(n){console.error("Grammar setup failed:",n)}}})}),(0,l.jsx)("div",{onMouseDown:()=>{L.current=!0},onDoubleClick:()=>F(u),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,l.jsx)("div",{ref:_,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,l.jsx)("canvas",{ref:E,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,l.jsx)("button",{onClick:P,disabled:v,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:v?"default":"pointer",opacity:v?.85:1,transition:"opacity 120ms ease"},children:v?"Working\u2026":"Compile & Render"})}),(0,l.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:R})]})]})}},8417:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"installation","title":"Installation","description":"<ShpzPlayground","source":"@site/docs/installation.mdx","sourceDirName":".","slug":"/installation","permalink":"/docs/installation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar"}');var o=n(4848),i=n(8453),s=n(3434);const a={sidebar_position:1},c="Installation",l={},u=[];function d(e){const t={h1:"h1",header:"header",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"installation",children:"Installation"})}),"\n",(0,o.jsx)(s.A,{src:"/examples/sphere.shpz",height:420,initialSplit:60,autoCompile:!0,caption:"Circle example"})]})}function f(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);