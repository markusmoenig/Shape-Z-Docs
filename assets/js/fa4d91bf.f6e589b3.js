(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[802],{419:()=>{},3434:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var n=r(6540),i=r(8553),o=r(4779),s=r(8918),a=r(8215);var c=r(4848);function l({src:e=null,code:t="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:r=400,initialSplit:l=80,autoCompile:d=!1,caption:u="",renderWidth:f=400,renderHeight:h=400,samplesPerFrame:m=1,totalSamples:p=64}){const[g,w]=(0,n.useState)(t),[y,x]=(0,n.useState)("Ready"),[v,b]=(0,n.useState)(!1),R=(0,n.useRef)(null),k=(0,n.useRef)(null),C=(0,n.useRef)(null),j=(0,n.useRef)(null),S=(0,n.useRef)(0),z=(0,n.useRef)(!1),_=(0,n.useRef)(null),M="undefined"!=typeof window,E=(0,n.useCallback)(e=>{if(!k.current||!C.current)return;const t=Math.min(90,Math.max(10,e));k.current.style.width=`${t}%`,C.current.style.width=100-t+"%"},[]),I=()=>{S.current&&cancelAnimationFrame(S.current),S.current=0};(0,n.useEffect)(()=>{if(!M)return;if(!e)return;if(I(),j.current){const e=j.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let t=!1;return x("Loading source\u2026"),fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to load ${e} (${t.status})`);return t.text()}).then(e=>{t||(w(e),x("Source loaded"))}).catch(e=>{t||(console.error(e),x("Load failed: "+(e.message||e)))}),()=>{t=!0}},[e,M]);const L=(0,n.useCallback)((e,t,r)=>{const n=j.current;if(!n)return;n.width!==t&&(n.width=t),n.height!==r&&(n.height=r);const i=n.getContext("2d");if(e&&e.length){const n=new ImageData(new Uint8ClampedArray(e),t,r);i.putImageData(n,0,0)}else i.clearRect(0,0,n.width,n.height)},[]),D=(0,n.useCallback)(async e=>{if(e.Renderer&&"function"==typeof e.Renderer){const r=new e.Renderer(g,f,h);if("function"==typeof r.set_target_samples)try{r.set_target_samples(p>>>0)}catch(t){}x(`Rendering 0% (0/${p} spp)`);const n=()=>{try{let e=!1;const i=m>>>0||1;if("function"==typeof r.step_samples)e=r.step_samples(i);else{if("function"!=typeof r.step)throw new Error("Renderer has no step/step_samples");e=r.step(i)}const o=r.frame_rgba();L(o,r.width,r.height);let s=0,a=null,c=p;if("function"==typeof r.progress)try{s=Math.max(0,Math.min(1,r.progress()))}catch(t){}if("function"==typeof r.current_samples)try{a=r.current_samples()}catch(t){}if("function"==typeof r.target_samples)try{c=r.target_samples()}catch(t){}null!=a&&c&&(s=Math.max(s,Math.min(1,a/c)));const l=Math.round(100*s);x(`Rendering ${l}%${null!=a?` (${a}/${c} spp)`:""}`),e?(x("Done"),S.current=0):S.current=requestAnimationFrame(n)}catch(e){console.error("Progressive render failed:",e),x("Render failed"),S.current=0}};return void n()}if("function"==typeof e.compile){x("Compiling\u2026");const t=e.compile(g);if(!t||0===t.length)throw new Error("Empty byte buffer");const r=new Blob([t],{type:"image/png"}),n=URL.createObjectURL(r),i=new Image;return i.onload=()=>{const e=j.current;if(!e)return;e.width=i.width,e.height=i.height;e.getContext("2d").drawImage(i,0,0),URL.revokeObjectURL(n),x("Done")},i.onerror=()=>x("Render failed"),void(i.src=n)}throw new Error("No rendering function found in WASM module")},[g,f,h,m,p,L]),$=(0,n.useCallback)(async()=>{I(),b(!0);try{if(!M||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){x("Checking\u2026");const t=e.compile_check(g,f,h),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;if(x(n||(r?"OK":"Error")),!r)return void b(!1)}await D(e)}catch(e){console.error(e),x(String(e.message||e))}finally{b(!1)}},[M,g,f,h,D]);(0,n.useEffect)(()=>{if(!M)return;const e=`shpz-split:${location.pathname}:${u||"default"}`;_.current=e;const t=Number(sessionStorage.getItem(e));E(!Number.isNaN(t)&&t>0?t:l)},[E,u,l,M]),(0,n.useEffect)(()=>{if(!d)return;const e=setTimeout(()=>$(),350);return()=>clearTimeout(e)},[g,d,$]);const W=e=>{if(!z.current||!R.current)return;const t=R.current.getBoundingClientRect(),r=(e.clientX-t.left)/t.width*100;E(r)},A=()=>{if(z.current&&(z.current=!1,M&&_.current&&k.current&&R.current)){const e=R.current.getBoundingClientRect(),t=k.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(_.current,String(Math.round(t)))}};return(0,n.useEffect)(()=>{if(M)return window.addEventListener("mousemove",W),window.addEventListener("mouseup",A),()=>{window.removeEventListener("mousemove",W),window.removeEventListener("mouseup",A),I()}},[M]),(0,c.jsxs)("div",{ref:R,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${r}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)"},children:[u?(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:(0,c.jsx)("span",{children:u})}):null,(0,c.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,c.jsx)("div",{ref:k,style:{width:"50%",minWidth:"20%"},children:(0,c.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:g,onChange:e=>w(e??""),theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1}},onMount:async(e,t)=>{try{await async function(e,t){const r=await fetch("/onigasm.wasm");await(0,a.loadWASM)(await r.arrayBuffer()),e.languages.register({id:"shpz"});const n=new o.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),i=new Map([["shpz","source.shpz"]]);await(0,s.J)(e,n,i,t)}(t,e)}catch(r){console.error("Grammar setup failed:",r)}}})}),(0,c.jsx)("div",{onMouseDown:()=>{z.current=!0},onDoubleClick:()=>E(l),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,c.jsx)("div",{ref:C,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,c.jsx)("canvas",{ref:j,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,c.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,c.jsx)("button",{onClick:$,disabled:v,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:v?"default":"pointer"},children:v?"Working\u2026":"Compile & Render"})}),(0,c.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:y})]})]})}},8417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"installation","title":"Installation","description":"<ShpzPlayground","source":"@site/docs/installation.mdx","sourceDirName":".","slug":"/installation","permalink":"/docs/installation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar"}');var i=r(4848),o=r(8453),s=r(3434);const a={sidebar_position:1},c="Installation",l={},d=[];function u(e){const t={h1:"h1",header:"header",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"installation",children:"Installation"})}),"\n",(0,i.jsx)(s.A,{src:"/examples/sphere.shpz",height:420,initialSplit:60,autoCompile:!0,caption:"Circle example"})]})}function f(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}}}]);