(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[1941],{419:()=>{},3434:(e,n,t)=>{"use strict";t.d(n,{A:()=>d});var r=t(6540),s=t(961),i=t(8553),o=t(4779),a=t(8918),c=t(8215);var l=t(4848);function d({src:e=null,code:n="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:t=400,initialSplit:d=80,autoCompile:h=!1,caption:u="",renderWidth:p=300,renderHeight:m=300,samplesPerFrame:f=1,totalSamples:g=10}){const[x,w]=(0,r.useState)(n),[y,v]=(0,r.useState)("Ready"),[j,b]=(0,r.useState)(!1),[k,R]=(0,r.useState)("Ready"),[C,S]=(0,r.useState)(""),M=(0,r.useRef)(null),z=(0,r.useRef)(null),_=(0,r.useRef)(null),E=(0,r.useRef)(null),D=(0,r.useRef)(0),L=(0,r.useRef)(!1),A=(0,r.useRef)(null),B="undefined"!=typeof window,F=async()=>{await new Promise(e=>requestAnimationFrame(()=>e())),await new Promise(e=>setTimeout(e,0))},I=(0,r.useCallback)(e=>{if(!z.current||!_.current)return;const n=Math.min(90,Math.max(10,e));z.current.style.width=`${n}%`,_.current.style.width=100-n+"%"},[]),W=()=>{D.current&&cancelAnimationFrame(D.current),D.current=0};(0,r.useEffect)(()=>{if(!B)return;if(!e)return;if(W(),E.current){const e=E.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let n=!1;return v("Loading source\u2026"),fetch(e).then(n=>{if(!n.ok)throw new Error(`Failed to load ${e} (${n.status})`);return n.text()}).then(e=>{n||(w(e),v("Source loaded"))}).catch(e=>{n||(console.error(e),v("Load failed: "+(e.message||e)))}),()=>{n=!0}},[e,B]);const T=(0,r.useCallback)((e,n,t)=>{const r=E.current;if(!r)return;r.width!==n&&(r.width=n),r.height!==t&&(r.height=t);const s=r.getContext("2d");if(e&&e.length){const r=new ImageData(new Uint8ClampedArray(e),n,t);s.putImageData(r,0,0)}else s.clearRect(0,0,r.width,r.height)},[]),$=(0,r.useCallback)(async e=>{if(e.Renderer&&"function"==typeof e.Renderer){const r=new e.Renderer(x,p,m);if("function"==typeof r.set_target_samples)try{r.set_target_samples(g>>>0)}catch(n){}let s=g>>>0;if("function"==typeof r.target_samples)try{s=r.target_samples()}catch(n){}try{if("function"==typeof r.prepare&&r.prepare(),"function"==typeof r.exec_summary){const e=r.exec_summary();e&&R(e)}}catch(t){return console.error("Renderer prepare failed:",t),void S("ERR")}await F(),S(`0/${s}`);const i=()=>{try{let e=!1;const t=f>>>0||1;if("function"==typeof r.step_samples)e=r.step_samples(t);else{if("function"!=typeof r.step)throw new Error("Renderer has no step/step_samples");e=r.step(t)}const o=r.frame_rgba();T(o,r.width,r.height);let a=0,c=null;if("function"==typeof r.progress)try{a=Math.max(0,Math.min(1,r.progress()))}catch(n){}if("function"==typeof r.current_samples)try{c=r.current_samples()}catch(n){}null!=c&&s&&(a=Math.max(a,Math.min(1,c/s)));Math.round(100*a);const l=null!=c?c:Math.round(a*s);S(`${l}/${s}`),e?(S(""),D.current=0):D.current=requestAnimationFrame(i)}catch(t){console.error("Progressive render failed:",t),S("ERR"),D.current=0}};return void i()}if("function"==typeof e.compile){v("Compiling\u2026");const n=e.compile(x);if(!n||0===n.length)throw new Error("Empty byte buffer");const t=new Blob([n],{type:"image/png"}),r=URL.createObjectURL(t),s=new Image;return s.onload=()=>{const e=E.current;if(!e)return;e.width=s.width,e.height=s.height;e.getContext("2d").drawImage(s,0,0),URL.revokeObjectURL(r),S("")},s.onerror=()=>v("Render failed"),void(s.src=r)}throw new Error("No rendering function found in WASM module")},[x,p,m,f,g,T]),N=(0,r.useCallback)(async()=>{W(),(0,s.flushSync)(()=>{b(!0),S("Compiling Voxels\u2026")}),await F();try{if(!B||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){v("Checking\u2026");const n=e.compile_check(x,p,m),t="function"==typeof n.ok?n.ok():n.ok,r="function"==typeof n.message?n.message():n.message;if(R(r||(t?"OK":"Error")),!t)return S(""),void b(!1)}await $(e)}catch(e){console.error(e),v(String(e.message||e)),S("")}finally{b(!1)}},[B,x,p,m,$]),P=(0,r.useCallback)(async()=>{W(),S("");try{if(!B||!window.shapezWasmModule)return;const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){v("Checking\u2026");const n=e.compile_check(x,p,m),t="function"==typeof n.ok?n.ok():n.ok,r="function"==typeof n.message?n.message():n.message;R(r||(t?"OK":"Error"))}}catch(e){console.error(e),v(String(e.message||e))}},[B,x,p,m]);(0,r.useEffect)(()=>{if(!B)return;const e=`shpz-split:${location.pathname}:${u||"default"}`;A.current=e;const n=Number(sessionStorage.getItem(e));I(!Number.isNaN(n)&&n>0?n:d)},[I,u,d,B]),(0,r.useEffect)(()=>{if(!h)return;const e=setTimeout(()=>P(),350);return()=>clearTimeout(e)},[x,h,P]);const O=e=>{if(!L.current||!M.current)return;const n=M.current.getBoundingClientRect(),t=(e.clientX-n.left)/n.width*100;I(t)},U=()=>{if(L.current&&(L.current=!1,B&&A.current&&z.current&&M.current)){const e=M.current.getBoundingClientRect(),n=z.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(A.current,String(Math.round(n)))}};return(0,r.useEffect)(()=>{if(B)return window.addEventListener("mousemove",O),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",U),W()}},[B]),(0,l.jsxs)("div",{ref:M,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${t}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)",marginBottom:"1.5rem"},children:[u?(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:[(0,l.jsx)("span",{children:u}),(0,l.jsx)("span",{style:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontVariantNumeric:"tabular-nums",opacity:.75},children:C})]}):null,(0,l.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,l.jsx)("div",{ref:z,style:{width:"50%",minWidth:"20%"},children:(0,l.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:x,onChange:e=>{W(),S(""),w(e??"")},theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1},scrollBeyondLastLine:!1},onMount:async(e,n)=>{try{await async function(e,n){const t=await fetch("/onigasm.wasm");await(0,c.loadWASM)(await t.arrayBuffer()),e.languages.register({id:"shpz"});const r=new o.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),s=new Map([["shpz","source.shpz"]]);await(0,a.J)(e,r,s,n)}(n,e)}catch(t){console.error("Grammar setup failed:",t)}}})}),(0,l.jsx)("div",{onMouseDown:()=>{L.current=!0},onDoubleClick:()=>I(d),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,l.jsx)("div",{ref:_,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,l.jsx)("canvas",{ref:E,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,l.jsx)("button",{onClick:N,disabled:j,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:j?"default":"pointer",opacity:j?.85:1,transition:"opacity 120ms ease"},children:j?"Working\u2026":"Compile & Render"})}),(0,l.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:k})]})]})}},3825:(e,n,t)=>{"use strict";t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"shapes","title":"Shapes and Segments","description":"Shape-Z defines high-level 2D shapes that can be extruded and subdivided with segments. These are the foundational building blocks for modeling walls, floors, and curved surfaces.","source":"@site/docs/shapes.mdx","sourceDirName":".","slug":"/shapes","permalink":"/docs/shapes","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Shapes and Segments"},"sidebar":"tutorialSidebar","previous":{"title":"Quick Start Guide","permalink":"/docs/quick_start"},"next":{"title":"Distance Volumes","permalink":"/docs/distance"}}');var s=t(4848),i=t(8453),o=t(3434);const a={sidebar_position:3,title:"Shapes and Segments"},c=void 0,l={},d=[{value:"Rect",id:"rect",level:3},{value:"Example",id:"example",level:4},{value:"Disc",id:"disc",level:3},{value:"Example",id:"example-1",level:4}];function h(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Shape-Z defines high-level ",(0,s.jsx)(n.strong,{children:"2D shapes"})," that can be extruded and subdivided with segments. These are the foundational building blocks for modeling walls, floors, and curved surfaces."]}),"\n",(0,s.jsx)(n.p,{children:"Inside shapes we have two helper variables:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sdf"})," \u2013 the raw signed distance (negative inside, positive outside)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"inside"})," \u2013 convenience alias for ",(0,s.jsx)(n.code,{children:"-sdf"})," (positive inside, zero on the surface)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"rect",children:"Rect"}),"\n",(0,s.jsxs)(n.p,{children:["A rectangular shape that spans the full domain in its plane. It supports ",(0,s.jsx)(n.strong,{children:"subsegments"})," like ",(0,s.jsx)(n.code,{children:"Floor"}),", ",(0,s.jsx)(n.code,{children:"Ceiling"}),", ",(0,s.jsx)(n.code,{children:"Left"}),", ",(0,s.jsx)(n.code,{children:"Right"}),", ",(0,s.jsx)(n.code,{children:"Back"}),", and ",(0,s.jsx)(n.code,{children:"Front"}),", which allow fine-grained control over geometry placement."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Coordinate system: ",(0,s.jsx)(n.strong,{children:"Cartesian"})]}),"\n",(0,s.jsxs)(n.li,{children:["Axes: ",(0,s.jsx)(n.code,{children:"u"}),", ",(0,s.jsx)(n.code,{children:"v"}),", ",(0,s.jsx)(n.code,{children:"d"})," (e.g., for a Floor segment, ",(0,s.jsx)(n.code,{children:"u = x"}),", ",(0,s.jsx)(n.code,{children:"v = z"}),", ",(0,s.jsx)(n.code,{children:"d = y"}),")"]}),"\n",(0,s.jsx)(n.li,{children:"Typical usage: Rooms, flat walls, layered architecture"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,s.jsx)(o.A,{code:"voxel Box size = vec3(3, 2, 3) {\n  shape Rect {\n      segment Floor depth = 0.2 {\n          Metal;\n      }\n      segment Left depth = 0.2 {\n          Metal;\n      }\n      segment Back depth = 0.2 {\n          Metal;\n      }\n  }\n}\n\nplace Box at = 0;",height:450,caption:"Rect Shape with Segmented Walls and Floor"}),"\n",(0,s.jsx)(n.h3,{id:"disc",children:"Disc"}),"\n",(0,s.jsxs)(n.p,{children:["A circular shape with a radial layout. It does ",(0,s.jsx)(n.strong,{children:"not support subsegments"}),", but instead provides ",(0,s.jsx)(n.code,{children:"u"}),", ",(0,s.jsx)(n.code,{children:"v"}),", and ",(0,s.jsx)(n.code,{children:"d"})," in ",(0,s.jsx)(n.strong,{children:"polar coordinates"}),", ideal for modeling towers, fans, and radial symmetry."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Coordinate system: ",(0,s.jsx)(n.strong,{children:"Polar"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"u"}),": angle (normalized 0\u20131)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"v"}),": radius (normalized)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"d"}),": height"]}),"\n",(0,s.jsx)(n.li,{children:"Typical usage: Cylindrical bases, circular panels, decorative columns"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(o.A,{code:"voxel Box size = 3 {\n  shape Disc {\n      Metal;\n  }\n}\n\nplace Box at = 0;",height:300,caption:"Disc shape with radial coordinates and cylinder"})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);