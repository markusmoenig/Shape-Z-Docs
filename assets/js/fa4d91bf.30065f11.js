(self.webpackChunkshape_z_docs=self.webpackChunkshape_z_docs||[]).push([[802],{419:()=>{},3434:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(6540),o=r(961),i=r(8553),s=r(4779),a=r(8918),c=r(8215);var l=r(4848);function u({src:e=null,code:t="shape Rect {\n  if inside { Color(1.0, 0.9, 0.8); }\n}",height:r=400,initialSplit:u=80,autoCompile:d=!1,caption:f="",renderWidth:m=400,renderHeight:h=400,samplesPerFrame:p=1,totalSamples:g=10}){const[y,w]=(0,n.useState)(t),[x,v]=(0,n.useState)("Ready"),[b,k]=(0,n.useState)(!1),[R,C]=(0,n.useState)("Ready"),[j,S]=(0,n.useState)(""),_=(0,n.useRef)(null),M=(0,n.useRef)(null),z=(0,n.useRef)(null),E=(0,n.useRef)(null),I=(0,n.useRef)(0),L=(0,n.useRef)(!1),W=(0,n.useRef)(null),A="undefined"!=typeof window,D=async()=>{await new Promise(e=>requestAnimationFrame(()=>e())),await new Promise(e=>setTimeout(e,0))},F=(0,n.useCallback)(e=>{if(!M.current||!z.current)return;const t=Math.min(90,Math.max(10,e));M.current.style.width=`${t}%`,z.current.style.width=100-t+"%"},[]),$=()=>{I.current&&cancelAnimationFrame(I.current),I.current=0};(0,n.useEffect)(()=>{if(!A)return;if(!e)return;if($(),E.current){const e=E.current;e.getContext("2d").clearRect(0,0,e.width,e.height)}let t=!1;return v("Loading source\u2026"),fetch(e).then(t=>{if(!t.ok)throw new Error(`Failed to load ${e} (${t.status})`);return t.text()}).then(e=>{t||(w(e),v("Source loaded"))}).catch(e=>{t||(console.error(e),v("Load failed: "+(e.message||e)))}),()=>{t=!0}},[e,A]);const N=(0,n.useCallback)((e,t,r)=>{const n=E.current;if(!n)return;n.width!==t&&(n.width=t),n.height!==r&&(n.height=r);const o=n.getContext("2d");if(e&&e.length){const n=new ImageData(new Uint8ClampedArray(e),t,r);o.putImageData(n,0,0)}else o.clearRect(0,0,n.width,n.height)},[]),B=(0,n.useCallback)(async e=>{if(e.Renderer&&"function"==typeof e.Renderer){const n=new e.Renderer(y,m,h);if("function"==typeof n.set_target_samples)try{n.set_target_samples(g>>>0)}catch(t){}let o=g>>>0;if("function"==typeof n.target_samples)try{o=n.target_samples()}catch(t){}try{if("function"==typeof n.prepare&&n.prepare(),"function"==typeof n.exec_summary){const e=n.exec_summary();e&&C(e)}}catch(r){return console.error("Renderer prepare failed:",r),void S("ERR")}await D(),S(`0/${o}`);const i=()=>{try{let e=!1;const r=p>>>0||1;if("function"==typeof n.step_samples)e=n.step_samples(r);else{if("function"!=typeof n.step)throw new Error("Renderer has no step/step_samples");e=n.step(r)}const s=n.frame_rgba();N(s,n.width,n.height);let a=0,c=null;if("function"==typeof n.progress)try{a=Math.max(0,Math.min(1,n.progress()))}catch(t){}if("function"==typeof n.current_samples)try{c=n.current_samples()}catch(t){}null!=c&&o&&(a=Math.max(a,Math.min(1,c/o)));Math.round(100*a);const l=null!=c?c:Math.round(a*o);S(`${l}/${o}`),e?(S(""),I.current=0):I.current=requestAnimationFrame(i)}catch(r){console.error("Progressive render failed:",r),S("ERR"),I.current=0}};return void i()}if("function"==typeof e.compile){v("Compiling\u2026");const t=e.compile(y);if(!t||0===t.length)throw new Error("Empty byte buffer");const r=new Blob([t],{type:"image/png"}),n=URL.createObjectURL(r),o=new Image;return o.onload=()=>{const e=E.current;if(!e)return;e.width=o.width,e.height=o.height;e.getContext("2d").drawImage(o,0,0),URL.revokeObjectURL(n),S("")},o.onerror=()=>v("Render failed"),void(o.src=n)}throw new Error("No rendering function found in WASM module")},[y,m,h,p,g,N]),P=(0,n.useCallback)(async()=>{$(),(0,o.flushSync)(()=>{k(!0),S("Compiling Voxels\u2026")}),await D();try{if(!A||!window.shapezWasmModule)throw new Error("WASM not ready");const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){v("Checking\u2026");const t=e.compile_check(y,m,h),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;if(C(n||(r?"OK":"Error")),!r)return S(""),void k(!1)}await B(e)}catch(e){console.error(e),v(String(e.message||e)),S("")}finally{k(!1)}},[A,y,m,h,B]),O=(0,n.useCallback)(async()=>{$(),S("");try{if(!A||!window.shapezWasmModule)return;const e=await window.shapezWasmModule;if("function"==typeof e.compile_check){v("Checking\u2026");const t=e.compile_check(y,m,h),r="function"==typeof t.ok?t.ok():t.ok,n="function"==typeof t.message?t.message():t.message;C(n||(r?"OK":"Error"))}}catch(e){console.error(e),v(String(e.message||e))}},[A,y,m,h]);(0,n.useEffect)(()=>{if(!A)return;const e=`shpz-split:${location.pathname}:${f||"default"}`;W.current=e;const t=Number(sessionStorage.getItem(e));F(!Number.isNaN(t)&&t>0?t:u)},[F,f,u,A]),(0,n.useEffect)(()=>{if(!d)return;const e=setTimeout(()=>O(),350);return()=>clearTimeout(e)},[y,d,O]);const T=e=>{if(!L.current||!_.current)return;const t=_.current.getBoundingClientRect(),r=(e.clientX-t.left)/t.width*100;F(r)},U=()=>{if(L.current&&(L.current=!1,A&&W.current&&M.current&&_.current)){const e=_.current.getBoundingClientRect(),t=M.current.getBoundingClientRect().width/e.width*100;sessionStorage.setItem(W.current,String(Math.round(t)))}};return(0,n.useEffect)(()=>{if(A)return window.addEventListener("mousemove",T),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",U),$()}},[A]),(0,l.jsxs)("div",{ref:_,style:{display:"flex",flexDirection:"column",border:"1px solid var(--ifm-color-emphasis-200, #ccc)",height:`${r}px`,width:"100%",overflow:"hidden",borderRadius:6,fontFamily:"var(--ifm-font-family-base)",background:"var(--ifm-background-color)"},children:[f?(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.4rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f7f7f7)",borderBottom:"1px solid var(--ifm-color-emphasis-200, #ccc)",fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:[(0,l.jsx)("span",{children:f}),(0,l.jsx)("span",{style:{fontFamily:"ui-monospace, SFMono-Regular, Menlo, monospace",fontVariantNumeric:"tabular-nums",opacity:.75},children:j})]}):null,(0,l.jsxs)("div",{style:{display:"flex",flex:1,overflow:"hidden"},children:[(0,l.jsx)("div",{ref:M,style:{width:"50%",minWidth:"20%"},children:(0,l.jsx)(i.Ay,{height:"100%",defaultLanguage:"shpz",value:y,onChange:e=>{$(),S(""),w(e??"")},theme:"vs-dark",options:{fontSize:14,minimap:{enabled:!1}},onMount:async(e,t)=>{try{await async function(e,t){const r=await fetch("/onigasm.wasm");await(0,c.loadWASM)(await r.arrayBuffer()),e.languages.register({id:"shpz"});const n=new s.Registry({getGrammarDefinition:async e=>"source.shpz"===e?{format:"json",content:await fetch("/grammars/shapez.tmLanguage.json").then(e=>e.text())}:null}),o=new Map([["shpz","source.shpz"]]);await(0,a.J)(e,n,o,t)}(t,e)}catch(r){console.error("Grammar setup failed:",r)}}})}),(0,l.jsx)("div",{onMouseDown:()=>{L.current=!0},onDoubleClick:()=>F(u),title:"Drag to resize \u2022 Double\u2011click to reset",style:{width:6,cursor:"col-resize",backgroundColor:"var(--ifm-color-emphasis-200, #eee)",zIndex:1}}),(0,l.jsx)("div",{ref:z,style:{width:"50%",minWidth:"20%",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--ifm-background-surface-color, #f9f9f9)"},children:(0,l.jsx)("canvas",{ref:E,style:{maxWidth:"100%",maxHeight:"100%"}})})]}),(0,l.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0.75rem",backgroundColor:"var(--ifm-color-emphasis-100, #f0f0f0)",borderTop:"1px solid var(--ifm-color-emphasis-200, #ccc)"},children:[(0,l.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,l.jsx)("button",{onClick:P,disabled:b,style:{padding:"0.35rem 0.8rem",borderRadius:6,border:"1px solid var(--ifm-color-primary)",background:"var(--ifm-color-primary)",color:"white",fontSize:13,lineHeight:1.2,cursor:b?"default":"pointer",opacity:b?.85:1,transition:"opacity 120ms ease"},children:b?"Working\u2026":"Compile & Render"})}),(0,l.jsx)("span",{style:{fontSize:13,color:"var(--ifm-color-emphasis-700, #555)"},children:R})]})]})}},8417:(e,t,r)=>{"use strict";r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>c,default:()=>f,frontMatter:()=>a,metadata:()=>n,toc:()=>u});const n=JSON.parse('{"id":"installation","title":"Installation","description":"<ShpzPlayground","source":"@site/docs/installation.mdx","sourceDirName":".","slug":"/installation","permalink":"/docs/installation","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar"}');var o=r(4848),i=r(8453),s=r(3434);const a={sidebar_position:1},c="Installation",l={},u=[];function d(e){const t={h1:"h1",header:"header",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"installation",children:"Installation"})}),"\n",(0,o.jsx)(s.A,{src:"/examples/sphere.shpz",height:420,initialSplit:60,autoCompile:!0,caption:"Circle example"})]})}function f(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);